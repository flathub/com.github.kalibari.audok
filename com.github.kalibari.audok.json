{
    "id" : "com.github.kalibari.audok",
    "runtime" : "org.gnome.Platform",
    "sdk": "org.gnome.Sdk",
    "runtime-version" : "41",
    "command" : "audok",
    "rename-desktop-file" : "audok.desktop",
    "rename-icon" : "audok",
    "finish-args" : [
        "--device=dri",
        "--share=ipc",
        "--share=network",
        "--filesystem=xdg-music",
        "--filesystem=xdg-download",
        "--filesystem=xdg-run/pipewire-0:ro",
        "--socket=fallback-x11",
        "--socket=pulseaudio",
        "--socket=wayland"
    ],
    "modules" : [
        {
            "name": "ffmpeg",
            "config-opts": [
              "--enable-rpath",
              "--enable-gpl",
              "--disable-static",
              "--enable-shared",
              "--disable-doc",
              "--disable-alsa",
              "--disable-libx264",
              "--disable-libx265",
              "--enable-libmp3lame"
            ],
            "sources": [{
              "type": "archive",
              "url": "https://www.ffmpeg.org/releases/ffmpeg-4.4.1.tar.gz",
              "sha512": "010db909d0769080b222b13a1b2d7fde5b0b093ce4691539cfcc3b46444c80be98112fae828d894bb3c8f097600d5e06bd1b41970ec87e7c1424ba637738b797"
            }],
            "cleanup": ["/share/ffmpeg/examples"]
        },
        {
            "name": "streamripper",
            "no-autogen": true,
            "no-make-install": false,
            "build-options": {
                "config-opts": [ "--disable-static" ]
            },
            "sources": [
                {
                "type": "archive",
                "url": "https://downloads.sourceforge.net/sourceforge/streamripper/streamripper-1.64.6.tar.gz",
                "sha512": "8477086d0099f6de861f1c47112476c427073b6e8127bbaaa2dd3e7930fe9a5c6d9b2c68d4a317f1bc0b20c625e665d5c245189049d35468aa83cf51828d4428"
                },
                {
                    "type": "shell",
                    "commands": [
                        "cp -p /usr/share/automake-*/config.{sub,guess} .",
                        "cp -p /usr/share/automake-*/config.{sub,guess} libmad-0.15.1b/"
                    ]
                }
            ]
        },
        {
            "name": "youtube-dl",
            "no-autogen": true,
            "no-make-install": false,
            "make-install-args": ["PREFIX=/app"],
            "sources": [{
              "type": "archive",
              "url": "https://github.com/ytdl-org/youtube-dl/releases/download/2021.12.17/youtube-dl-2021.12.17.tar.gz",
              "sha512": "bfc8280703b08f66e1108e9ebd9ab4689f064ac7cef03bd3d1fd2bc64928570e4376e389c9bc188eafdbcd74444cfc8aeccc83ee362ad4f478910efef3573ddb"
            }]
        },
        {
            "name" : "audok",
            "no-autogen": true,
            "make-install-args": ["PREFIX=/app", "APPDIR=/app/audok"],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/kalibari/audok/archive/refs/tags/v1.0.3.tar.gz",
                    "sha512": "3aa1c2eda27fc6e45ae48e97bccd7c749d68ce4a7341f1029a8b28ab561b31cb4841c01566f8d7747b3633d32d251d43aa9944f9560771effa3da453a7956abd"
                },
                {
                    "type": "file",
                    "path": "com.github.kalibari.audok.appdata.xml"
                }
            ],
            "post-install": [
                "install -Dm644 com.github.kalibari.audok.appdata.xml /app/share/appdata/com.github.kalibari.audok.appdata.xml"           
            ]
        }
    ]
}
